================================================================================
              STAFF ATTENDANCE SYSTEM - VISUAL FLOW DIAGRAM
================================================================================

                         USER AUTHENTICATION FLOW
================================================================================

                          [http://localhost:3000]
                                    |
                              Login Page
                                    |
                    +--------------+---------------+
                    |                              |
            Admin Login                      Staff Login
          (admin@example.com)              (staff@example.com)
                    |                              |
          POST /api/auth/login           POST /api/auth/login
                    |                              |
            JWT Token Created                JWT Token Created
                    |                              |
         +----------+----------+         +---------+---------+
         |                     |         |                   |
    HTTP-only Cookie      localStorage   HTTP-only Cookie   localStorage
         |                     |         |                   |
         +---------+-----------+         +---------+---------+
                   |                               |
           Admin Dashboard                  Staff Dashboard
         /admin/staff                    /staff/dashboard


================================================================================
                         ADMIN WORKFLOW
================================================================================

                           Admin Dashboard
                        /admin/staff page
                                |
                    +-----------+-----------+
                    |                       |
              View All Staff          Create New Staff
                    |                       |
         +----------+----------+    +-------+-------+
         |                     |    |               |
    Staff List Table      Delete Staff   Fill Form:
         |                     |          - Email
    - Name                     |          - Password
    - Email               DELETE API      - Full Name
    - Salary                   |          - Salary
    - Office Hours             |          - Working Days
    - Working Days    /api/admin/staff/:id - Office Hours
                                |               |
                          Staff Deleted    POST /api/admin/staff
                                                |
                                          Staff Created
                                                |
                                    Email & password saved
                                    Staff can now login


================================================================================
                         STAFF DAILY WORKFLOW
================================================================================

                         Staff Dashboard
                      /staff/dashboard
                              |
              +---------------+---------------+
              |                               |
        Monthly Calendar              Punch Actions Panel
              |                               |
    View Past Attendance            Check Current Status
              |                               |
    +--------+--------+              +-------+-------+
    |                 |              |               |
  Green Days     Red Days      Not Punched In   Punched In
  (Present)      (Absent)           |               |
    |                 |              v               v
  Shows:         Shows:         PUNCH IN         PUNCH OUT
  - In Time      - Missed           or               or
  - Out Time     - Date          LUNCH START    LUNCH END
  - Hours                            |               |
                                     v               v
                              Location Request   Location Request
                                     |               |
                              User Allows GPS    User Allows GPS
                                     |               |
                              Coordinates Sent   Coordinates Sent
                                     |               |
                              API Call Made      API Call Made
                                     |               |
                              Record Saved       Record Updated


================================================================================
                    DETAILED PUNCH IN/OUT FLOW
================================================================================

STEP 1: PUNCH IN
================
Staff Dashboard â†’ Click "ğŸ• Punch In" Button
        |
        +--> Browser requests location permission
        |
        +--> User allows location
        |
        +--> GPS captures: latitude, longitude
        |
        +--> POST /api/staff/punch-in
        |    Body: { latitude, longitude }
        |    Headers: Authorization: Bearer <JWT_TOKEN>
        |
        +--> API validates JWT token
        |
        +--> API checks if already punched in today
        |
        +--> Create AttendanceRecord:
        |    {
        |      userId: 123,
        |      punchInTime: "2024-11-28 09:00:00",
        |      punchInLat: 25.2048,
        |      punchInLng: 55.2708,
        |      date: "2024-11-28"
        |    }
        |
        +--> Status changes to "Punched In"
        |
        +--> Dashboard refreshes
        |
        +--> Shows: "Punch In: 09:00 AM"


STEP 2: LUNCH BREAK START
==========================
Staff Dashboard â†’ Click "ğŸ½ï¸ Start Lunch" Button
        |
        +--> Browser requests location permission
        |
        +--> GPS captures: latitude, longitude
        |
        +--> POST /api/staff/lunch-start
        |    Body: { latitude, longitude }
        |
        +--> API finds today's AttendanceRecord
        |
        +--> Create LunchBreak:
        |    {
        |      userId: 123,
        |      attendanceRecordId: 456,
        |      lunchStartTime: "2024-11-28 13:00:00",
        |      lunchStartLat: 25.2048,
        |      lunchStartLng: 55.2708
        |    }
        |
        +--> Status changes to "On Lunch Break"
        |
        +--> Dashboard shows lunch button: "âœ“ End Lunch Break"


STEP 3: LUNCH BREAK END
========================
Staff Dashboard â†’ Click "âœ“ End Lunch Break" Button
        |
        +--> Browser requests location permission
        |
        +--> GPS captures: latitude, longitude
        |
        +--> POST /api/staff/lunch-end
        |    Body: { latitude, longitude }
        |
        +--> API finds active lunch break
        |
        +--> Calculate duration:
        |    lunchEndTime - lunchStartTime = 60 minutes
        |
        +--> Update LunchBreak:
        |    {
        |      lunchEndTime: "2024-11-28 14:00:00",
        |      lunchEndLat: 25.2048,
        |      lunchEndLng: 55.2708,
        |      duration: 60
        |    }
        |
        +--> Status changes back to "Punched In"


STEP 4: PUNCH OUT
==================
Staff Dashboard â†’ Click "ğŸ Punch Out" Button
        |
        +--> Browser requests location permission
        |
        +--> GPS captures: latitude, longitude
        |
        +--> POST /api/staff/punch-out
        |    Body: { latitude, longitude }
        |
        +--> API checks for active lunch break
        |    (must end lunch before punch out)
        |
        +--> Calculate working hours:
        |    Total Time = 18:00 - 09:00 = 9 hours
        |    Lunch Time = 60 minutes = 1 hour
        |    Working Hours = 9 - 1 = 8 hours
        |
        +--> Update AttendanceRecord:
        |    {
        |      punchOutTime: "2024-11-28 18:00:00",
        |      punchOutLat: 25.2048,
        |      punchOutLng: 55.2708,
        |      workingHours: 8.00
        |    }
        |
        +--> Status changes to "Punched Out"
        |
        +--> Shows: "Attendance completed! ğŸ‰"
        |
        +--> Calendar updates with green box
        |    Shows: In: 09:00, Out: 18:00, Hours: 8.00


================================================================================
                         DATABASE RELATIONSHIPS
================================================================================

User (Authentication)
  |
  +--> StaffProfile (1:1)
  |     - fullName
  |     - salary
  |     - workingDays
  |     - officeTimeIn
  |     - officeTimeOut
  |
  +--> AttendanceRecord (1:Many)
        - punchInTime, punchInLat, punchInLng
        - punchOutTime, punchOutLat, punchOutLng
        - workingHours
        - date
        |
        +--> LunchBreak (1:Many)
              - lunchStartTime, lunchStartLat, lunchStartLng
              - lunchEndTime, lunchEndLat, lunchEndLng
              - duration


Example Data:
=============
User:
  id: 1
  email: "john@company.com"
  role: "STAFF"

StaffProfile:
  userId: 1
  fullName: "John Doe"
  salary: 50000
  workingDays: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"]
  officeTimeIn: "09:00"
  officeTimeOut: "18:00"

AttendanceRecord (Nov 28):
  id: 100
  userId: 1
  date: "2024-11-28"
  punchInTime: "2024-11-28 09:05:00"
  punchInLat: 25.2048
  punchInLng: 55.2708
  punchOutTime: "2024-11-28 18:02:00"
  punchOutLat: 25.2048
  punchOutLng: 55.2708
  workingHours: 8.00

LunchBreak:
  id: 200
  userId: 1
  attendanceRecordId: 100
  lunchStartTime: "2024-11-28 13:00:00"
  lunchStartLat: 25.2048
  lunchStartLng: 55.2708
  lunchEndTime: "2024-11-28 14:00:00"
  lunchEndLat: 25.2048
  lunchEndLng: 55.2708
  duration: 60


================================================================================
                         API REQUEST/RESPONSE FLOW
================================================================================

EXAMPLE: Punch In Request
==========================

1. Frontend (React Component)
   â†“
   PunchButtons.tsx
   â†“
   handlePunchIn() called
   â†“
   getCurrentLocation() â†’ Browser Geolocation API
   â†“
   { latitude: 25.2048, longitude: 55.2708 }
   â†“
   fetch('/api/staff/punch-in', {
     method: 'POST',
     headers: {
       'Content-Type': 'application/json',
       'Authorization': 'Bearer eyJhbGc...'
     },
     body: JSON.stringify({ latitude, longitude })
   })

2. Backend (Next.js API Route)
   â†“
   /app/api/staff/punch-in/route.ts
   â†“
   requireAuth(request) â†’ Verify JWT
   â†“
   Get userId from token
   â†“
   Check if already punched in
   â†“
   prisma.attendanceRecord.create({
     userId, punchInTime, punchInLat, punchInLng, date
   })
   â†“
   Return Response:
   {
     success: true,
     attendance: { ... }
   }

3. Frontend (React Component)
   â†“
   Receive response
   â†“
   onSuccess() called
   â†“
   fetchAttendance() â†’ Refresh data
   â†“
   Component re-renders with new status


================================================================================
                    MONTHLY CALENDAR DATA FLOW
================================================================================

Staff Dashboard
      |
      v
Select Month: "2024-11"
      |
      v
GET /api/staff/attendance?month=2024-11
      |
      v
API receives request
      |
      v
Parse month: startDate = 2024-11-01, endDate = 2024-11-30
      |
      v
Query database:
  attendanceRecords = SELECT * FROM attendance_records
                      WHERE userId = 123
                      AND date BETWEEN '2024-11-01' AND '2024-11-30'
      |
      v
Include related lunch breaks
      |
      v
Return:
{
  attendanceRecords: [
    {
      id: 1,
      date: "2024-11-01",
      punchInTime: "09:00",
      punchOutTime: "18:00",
      workingHours: 8.00,
      lunchBreaks: [...]
    },
    // ... more records
  ],
  todayStatus: {
    status: "punched_in",
    record: {...}
  }
}
      |
      v
Frontend receives data
      |
      v
AttendanceCalendar component
      |
      v
Generate calendar grid (7x5 or 7x6)
      |
      v
For each day:
  - Check if working day
  - Find attendance record
  - Display status:
    * Green if present
    * Red if absent
    * Yellow if active
    * Gray if off day
      |
      v
Calculate statistics:
  - Total working days
  - Days present
  - Total hours worked
      |
      v
Display calendar with stats


================================================================================
                         SECURITY FLOW
================================================================================

Password Security:
==================
User Registration
      |
      v
Password: "mypassword123"
      |
      v
bcrypt.hash(password, 10)
      |
      v
Hashed: "$2a$10$N9qo8u..."
      |
      v
Stored in database (NEVER plain text)


Login:
======
User enters password
      |
      v
bcrypt.compare(enteredPassword, hashedPassword)
      |
      v
Returns true/false
      |
      v
If true: Generate JWT token


JWT Token:
==========
{
  userId: 123,
  email: "john@company.com",
  role: "STAFF"
}
      |
      v
jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' })
      |
      v
Token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      |
      v
Sent to client:
  - localStorage (accessible by JS)
  - HTTP-only cookie (not accessible by JS - more secure)


API Authorization:
==================
Request â†’ API Endpoint
      |
      v
requireAuth(request)
      |
      v
Extract token from:
  - Authorization header: "Bearer <token>"
  - Cookie: "token=<token>"
      |
      v
jwt.verify(token, JWT_SECRET)
      |
      v
If valid: Extract userId, email, role
If invalid: Return 401 Unauthorized
      |
      v
Check role for admin endpoints:
  requireAdmin() â†’ role must be "ADMIN"
      |
      v
Proceed with request


================================================================================
                    WORKING HOURS CALCULATION
================================================================================

Example Scenario:
=================
Punch In:  09:00 AM
Lunch:     01:00 PM - 02:00 PM (60 minutes)
Punch Out: 06:00 PM

Calculation:
============
Total Time = Punch Out - Punch In
           = 18:00 - 09:00
           = 9 hours = 540 minutes

Lunch Duration = 60 minutes

Working Time = Total Time - Lunch Duration
             = 540 - 60
             = 480 minutes
             = 8 hours

Stored in Database:
===================
AttendanceRecord.workingHours = 8.00

Multiple Lunch Breaks:
======================
Lunch 1: 12:00 PM - 12:30 PM (30 minutes)
Lunch 2: 03:00 PM - 03:15 PM (15 minutes)

Total Lunch = 30 + 15 = 45 minutes

Working Time = 540 - 45 = 495 minutes = 8.25 hours


================================================================================
                    LOCATION TRACKING FLOW
================================================================================

User Clicks Punch Button
      |
      v
navigator.geolocation.getCurrentPosition()
      |
      v
Browser asks user: "Allow location access?"
      |
      +---Yes---------+----------No-----------+
      |                                        |
      v                                        v
Get GPS Coordinates                    Error: "Location denied"
      |                                        |
      v                                        v
Position object:                     Show error message
{                                    Cannot proceed
  coords: {
    latitude: 25.2048,
    longitude: 55.2708,
    accuracy: 10,        (meters)
    altitude: null,
    altitudeAccuracy: null,
    heading: null,
    speed: null
  },
  timestamp: 1234567890
}
      |
      v
Extract latitude & longitude
      |
      v
Send to API with attendance action
      |
      v
Store in database:
  - punchInLat, punchInLng
  - punchOutLat, punchOutLng
  - lunchStartLat, lunchStartLng
  - lunchEndLat, lunchEndLng


Use Cases:
==========
1. Verify staff is at office location
2. Track remote work locations
3. Audit attendance locations
4. Prevent time theft
5. Compliance and reporting


================================================================================
                         COMPONENT HIERARCHY
================================================================================

App Root (layout.tsx)
  |
  +-- Login Page (/)
  |     â””â”€â”€ Login Form
  |
  +-- Admin Dashboard (/admin/staff)
  |     â”œâ”€â”€ Header (with Logout)
  |     â”œâ”€â”€ Create Staff Button
  |     â”œâ”€â”€ CreateStaffForm component
  |     â””â”€â”€ StaffList component
  |           â””â”€â”€ Staff Table Rows
  |
  â””-- Staff Dashboard (/staff/dashboard)
        â”œâ”€â”€ Header (with Logout)
        â”œâ”€â”€ Staff Info Display
        â”œâ”€â”€ PunchButtons component
        â”‚     â”œâ”€â”€ Status Indicator
        â”‚     â”œâ”€â”€ Punch In Button
        â”‚     â”œâ”€â”€ Lunch Start/End Buttons
        â”‚     â””â”€â”€ Punch Out Button
        â”œâ”€â”€ Month Selector
        â””â”€â”€ AttendanceCalendar component
              â”œâ”€â”€ Statistics Cards
              â”‚     â”œâ”€â”€ Total Working Days
              â”‚     â”œâ”€â”€ Days Present
              â”‚     â””â”€â”€ Total Hours
              â””â”€â”€ Calendar Grid
                    â””â”€â”€ Day Cells (with attendance info)


================================================================================
                         TECHNOLOGY STACK LAYERS
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PRESENTATION LAYER                        â”‚
â”‚  React Components + Tailwind CSS + TypeScript                â”‚
â”‚  - Login Page, Admin Dashboard, Staff Dashboard              â”‚
â”‚  - Responsive Design, Modern UI                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APPLICATION LAYER                          â”‚
â”‚  Next.js App Router + API Routes                             â”‚
â”‚  - Client-side navigation                                    â”‚
â”‚  - Server-side rendering                                     â”‚
â”‚  - API endpoint handlers                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BUSINESS LOGIC LAYER                      â”‚
â”‚  TypeScript Functions + Utilities                            â”‚
â”‚  - Authentication (JWT, bcrypt)                              â”‚
â”‚  - Authorization (role-based)                                â”‚
â”‚  - Date calculations                                         â”‚
â”‚  - Location handling                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA ACCESS LAYER                          â”‚
â”‚  Prisma ORM                                                  â”‚
â”‚  - Type-safe queries                                         â”‚
â”‚  - Database migrations                                       â”‚
â”‚  - Relationship handling                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE LAYER                           â”‚
â”‚  MySQL 8+                                                    â”‚
â”‚  - users, staff_profiles                                     â”‚
â”‚  - attendance_records, lunch_breaks                          â”‚
â”‚  - Indexes, constraints, relations                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    REQUEST LIFECYCLE EXAMPLE
================================================================================

User Action: Staff clicks "Punch In"
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. BROWSER (Client Side)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PunchButtons.tsx                            â”‚
   â”‚ handlePunchIn() called                      â”‚
   â”‚   â†“                                         â”‚
   â”‚ getCurrentLocation()                        â”‚
   â”‚   â†“                                         â”‚
   â”‚ Browser Geolocation API                     â”‚
   â”‚   â†“                                         â”‚
   â”‚ User allows location                        â”‚
   â”‚   â†“                                         â”‚
   â”‚ Coordinates received                        â”‚
   â”‚   â†“                                         â”‚
   â”‚ fetch('/api/staff/punch-in', {             â”‚
   â”‚   method: 'POST',                           â”‚
   â”‚   headers: { Authorization: Bearer token }, â”‚
   â”‚   body: { latitude, longitude }             â”‚
   â”‚ })                                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     |
                     | HTTP POST
                     â†“
2. SERVER (Next.js API)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ /app/api/staff/punch-in/route.ts           â”‚
   â”‚   â†“                                         â”‚
   â”‚ Receive request                             â”‚
   â”‚   â†“                                         â”‚
   â”‚ requireAuth(request)                        â”‚
   â”‚   â†“                                         â”‚
   â”‚ Verify JWT token                            â”‚
   â”‚   â†“                                         â”‚
   â”‚ Extract userId from token                   â”‚
   â”‚   â†“                                         â”‚
   â”‚ Parse request body                          â”‚
   â”‚   â†“                                         â”‚
   â”‚ Validate latitude, longitude                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     |
                     | Prisma Query
                     â†“
3. DATABASE (MySQL)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Check existing attendance                    â”‚
   â”‚ SELECT * FROM attendance_records             â”‚
   â”‚ WHERE userId = ? AND date = TODAY            â”‚
   â”‚   â†“                                         â”‚
   â”‚ If not exists:                              â”‚
   â”‚ INSERT INTO attendance_records               â”‚
   â”‚ (userId, punchInTime, punchInLat,           â”‚
   â”‚  punchInLng, date)                          â”‚
   â”‚ VALUES (?, ?, ?, ?, ?)                      â”‚
   â”‚   â†“                                         â”‚
   â”‚ Return new record                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     |
                     | Prisma Result
                     â†“
4. SERVER (Response)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Record created successfully                  â”‚
   â”‚   â†“                                         â”‚
   â”‚ Format response:                            â”‚
   â”‚ {                                           â”‚
   â”‚   success: true,                            â”‚
   â”‚   attendance: { ... }                       â”‚
   â”‚ }                                           â”‚
   â”‚   â†“                                         â”‚
   â”‚ Send HTTP 200 OK                            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     |
                     | HTTP Response
                     â†“
5. BROWSER (Client Side)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Response received                            â”‚
   â”‚   â†“                                         â”‚
   â”‚ if (response.ok)                            â”‚
   â”‚   â†“                                         â”‚
   â”‚ onSuccess() called                          â”‚
   â”‚   â†“                                         â”‚
   â”‚ fetchAttendance() - refresh data            â”‚
   â”‚   â†“                                         â”‚
   â”‚ Component re-renders                        â”‚
   â”‚   â†“                                         â”‚
   â”‚ Status updates to "Punched In"              â”‚
   â”‚   â†“                                         â”‚
   â”‚ Show success feedback                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Total Time: ~1-2 seconds
Components Involved: 7
Database Queries: 2
API Calls: 1


================================================================================
                              END OF FLOW DIAGRAM
================================================================================

For more details, see:
  - README.md for complete documentation
  - PROJECT_OVERVIEW.md for architecture details
  - NEXT_STEPS.md for setup instructions

================================================================================

